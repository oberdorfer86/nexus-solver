{% extends 'base.html' %}

{% block extra_css %}
<link data-nexus-block="1:Estilos Locais (CSS)" rel="stylesheet" href="{{ url_for('solver_static', path='css/style.css') }}?v=8.4">
<link rel="stylesheet" href="{{ url_for('functions_panel_static', path='style.css') }}?v=1.0">
<style>
/* Padding dinâmico do micro-app */
.solver-page {
    /* CRÍTICO: Removendo padding fixo e transições. O espaçamento é herdado do .main-content. */
    padding-left: 0;
    padding-right: 0;
    transition: none;
}

/* Removido media query de 1200px (não é mais necessário) */
</style>
{% endblock %}







{% block content %}
<div class="solver-page" data-nexus-block="2:Conteudo Principal (Micro-App)">

    <div class="editor-section">
        <div id="functions-panel-container"></div>

        <div class="variables-panel">
            <div class="variables-header">
                <span class="panel-title">
                    <span class="material-icons-round" style="font-size: 1.1rem;">data_object</span>
                    Variáveis de Projeto
                </span>
                <button id="add-variable-btn" class="btn-xs primary" title="Adicionar nova variável">
                    <span class="material-icons-round">add</span> Nova
                </button>
            </div>
            <div id="variables-list" class="variables-grid"></div>
        </div>

        <div class="unified-input-wrapper">
            <div class="label-group">
                <input type="text" id="calc-label" placeholder="Nomeie este cálculo (ex: Momento Máximo)...">
            </div>

            <div class="input-group">
                <math-field id="math-editor" smart-mode placeholder="Digite\ sua\ expressão..."></math-field>
                <div class="editor-actions">
                    <button id="clear-btn" class="btn-primary danger" title="Limpar Tudo">
                        <span class="material-icons-round">delete_outline</span>
                        Limpar
                    </button>
                    <button id="calculate-btn" class="btn-primary">
                        <span class="material-icons-round calculate-icon">calculate</span>
                        <span class="material-icons-round loading-icon">autorenew</span>
                        Calcular
                    </button>
                </div>
            </div>
        </div>

        <details class="tech-footer">
            <summary>
                <span class="material-icons-round" style="font-size:1.1rem; color:var(--text-muted);">code</span>
                <span style="margin-left: 5px;">Ver Códigos (Excel / LaTeX)</span>
            </summary>
            <div class="tech-content">
                <div class="tech-group">
                    <label for="excel-code">Para Excel:</label>
                    <input type="text" id="excel-code" readonly placeholder="O código Excel aparecerá aqui..." onclick="this.select()">
                </div>
                <div class="tech-group">
                    <label for="latex-code">LaTeX:</label>
                    <input type="text" id="latex-code" readonly placeholder="O código LaTeX aparecerá aqui..." onclick="this.select()">
                </div>
            </div>
        </details>
    </div>

    <div id="result-area" class="result-card hidden">
        <div class="result-header">
            <div style="display:flex; align-items:center; gap:10px;">
                <h3>Resultado</h3>
                <button id="save-var-btn" class="btn-secondary save-result-btn" title="Salvar resultado como Variável">
                    <span class="material-icons-round">save_alt</span> Salvar como Variável
                </button>
            </div>
        </div>

        <math-field id="result-output" read-only style="font-size: 2.2rem;"></math-field>

        <div id="plot-container">
            <div id="plotly-graph" style="width:100%; height:500px;"></div>
        </div>
    </div>
</div>
{% endblock %}





{% block extra_scripts %}
<script data-nexus-block="3:Scripts Extras" src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script defer src="//unpkg.com/mathlive"></script>
<script src="https://cdn.plot.ly/plotly-2.27.0.min.js" charset="utf-8"></script>
<script type="module" src="{{ url_for('functions_panel_static', path='index.js') }}?v=1.0"></script>
<script src="{{ url_for('solver_static', path='js/main.js') }}?v=8.4"></script>
{% endblock %}
